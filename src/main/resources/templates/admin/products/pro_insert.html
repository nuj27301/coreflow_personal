<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layouts/ad_layout}">
  
	<th:block layout:fragment="script1"> 
		<script src="/ckeditor/ckeditor.js"></script>
	</th:block>

	<th:block layout:fragment="style1">
	<style>
		/* 메인 카드 스타일 */
		.card-primary {
		  border: none !important;
		  border-radius: 16px !important;
		  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04) !important;
		  background: linear-gradient(135deg, #fdfbfb 0%, #f6f9fc 100%) !important;
		  overflow: hidden !important;
		  animation: fadeInUp 0.5s ease !important;
		}
		
		.card-header {
		  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
		  border: none !important;
		  padding: 20px 24px !important;
		}
		
		.card-title {
		  color: #ffffff !important;
		  font-size: 20px !important;
		  font-weight: 600 !important;
		  margin: 0 !important;
		}
		
		.card-body {
		  padding: 32px !important;
		  background: transparent !important;
		}
		
		/* 폼 그룹 스타일 */
		.form-group {
		  margin-bottom: 24px !important;
		}
		
		.form-group label {
		  font-size: 14px !important;
		  font-weight: 600 !important;
		  color: #4a5568 !important;
		  margin-bottom: 10px !important;
		  display: block !important;
		}
		
		/* Input 스타일 */
		.form-control {
		  border: 2px solid rgba(0, 0, 0, 0.08) !important;
		  border-radius: 8px !important;
		  padding: 12px 16px !important;
		  font-size: 14px !important;
		  transition: all 0.3s ease !important;
		  background: #ffffff !important;
		}
		
		.form-control:focus {
		  border-color: #667eea !important;
		  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
		  outline: none !important;
		}
		
		.form-control::placeholder {
		  color: #cbd5e0 !important;
		}
		
		/* Select 스타일 */
		.custom-select {
		  border: 2px solid rgba(0, 0, 0, 0.08) !important;
		  border-radius: 8px !important;
		  padding: 12px 16px !important;
		  font-size: 14px !important;
		  transition: all 0.3s ease !important;
		  background: #ffffff !important;
		  appearance: none !important;
		  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23667eea' d='M6 9L1 4h10z'/%3E%3C/svg%3E") !important;
		  background-repeat: no-repeat !important;
		  background-position: right 12px center !important;
		  padding-right: 36px !important;
		}
		
		.custom-select:focus {
		  border-color: #667eea !important;
		  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
		  outline: none !important;
		}
		
		/* Textarea 스타일 */
		textarea.form-control {
		  min-height: 120px !important;
		  resize: vertical !important;
		}
		
		/* 파일 업로드 스타일 */
		.custom-file {
		  position: relative !important;
		  display: inline-block !important;
		  width: 100% !important;
		  height: calc(2.25rem + 2px) !important;
		  margin-bottom: 0 !important;
		}
		
		.custom-file-input {
		  position: relative !important;
		  z-index: 2 !important;
		  width: 100% !important;
		  height: calc(2.25rem + 2px) !important;
		  margin: 0 !important;
		  opacity: 0 !important;
		  cursor: pointer !important;
		}
		
		.custom-file-label {
		  position: absolute !important;
		  top: 0 !important;
		  right: 0 !important;
		  left: 0 !important;
		  z-index: 1 !important;
		  height: calc(2.25rem + 2px) !important;
		  padding: 12px 16px !important;
		  font-weight: 400 !important;
		  line-height: 1.5 !important;
		  color: #718096 !important;
		  background-color: #ffffff !important;
		  border: 2px solid rgba(0, 0, 0, 0.08) !important;
		  border-radius: 8px !important;
		  transition: all 0.3s ease !important;
		}
		
		.custom-file-input:focus ~ .custom-file-label {
		  border-color: #667eea !important;
		  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
		}
		
		.input-group-append .input-group-text {
		  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
		  color: #ffffff !important;
		  border: none !important;
		  border-radius: 8px !important;
		  padding: 12px 20px !important;
		  font-weight: 600 !important;
		  font-size: 14px !important;
		  margin-left: 8px !important;
		}
		
		/* 이미지 미리보기 */
		#img_preview {
		  width: 200px !important;
		  height: 200px !important;
		  border-radius: 12px !important;
		  object-fit: cover !important;
		  border: 2px solid rgba(0, 0, 0, 0.08) !important;
		  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
		  transition: all 0.3s ease !important;
		}
		
		#img_preview:hover {
		  transform: scale(1.05) !important;
		  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08) !important;
		}
		
		/* 라디오 버튼 스타일 */
		.form-check-inline {
		  margin-right: 20px !important;
		}
		
		.form-check-input {
		  width: 18px !important;
		  height: 18px !important;
		  cursor: pointer !important;
		  accent-color: #667eea !important;
		  margin-right: 8px !important;
		}
		
		.form-check-label {
		  font-size: 14px !important;
		  color: #4a5568 !important;
		  cursor: pointer !important;
		  font-weight: 500 !important;
		}
		
		/* 버튼 스타일 */
		.card-footer {
		  background: transparent !important;
		  border: none !important;
		  padding: 24px 32px !important;
		  text-align: center !important;
		}
		
		.btn-primary {
		  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
		  border: none !important;
		  border-radius: 8px !important;
		  padding: 12px 48px !important;
		  font-weight: 600 !important;
		  font-size: 15px !important;
		  transition: all 0.3s ease !important;
		  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3) !important;
		  color: #ffffff !important;
		}
		
		.btn-primary:hover {
		  transform: translateY(-2px) !important;
		  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4) !important;
		}
		
		.btn-primary:active {
		  transform: translateY(0) !important;
		}
		
		/* 카테고리 선택 영역 스타일 개선 */
		.form-group:first-child {
		  background: #ffffff !important;
		  padding: 20px !important;
		  border-radius: 12px !important;
		  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
		  border: 1px solid rgba(102, 126, 234, 0.1) !important;
		}
		
		/* Number input 화살표 스타일 */
		input[type="number"]::-webkit-inner-spin-button,
		input[type="number"]::-webkit-outer-spin-button {
		  opacity: 1 !important;
		  cursor: pointer !important;
		}
		
		/* 애니메이션 효과 */
		@keyframes fadeInUp {
		  from {
		    opacity: 0;
		    transform: translateY(20px);
		  }
		  to {
		    opacity: 1;
		    transform: translateY(0);
		  }
		}
		
		.form-group {
		  animation: fadeInUp 0.6s ease !important;
		}
		
		.form-group:nth-child(1) { animation-delay: 0.05s !important; }
		.form-group:nth-child(2) { animation-delay: 0.1s !important; }
		.form-group:nth-child(3) { animation-delay: 0.15s !important; }
		.form-group:nth-child(4) { animation-delay: 0.2s !important; }
		.form-group:nth-child(5) { animation-delay: 0.25s !important; }
		.form-group:nth-child(6) { animation-delay: 0.3s !important; }
		.form-group:nth-child(7) { animation-delay: 0.35s !important; }
		.form-group:nth-child(8) { animation-delay: 0.4s !important; }
		.form-group:nth-child(9) { animation-delay: 0.45s !important; }
		
		/* CKEditor 스타일 개선 */
		.cke {
		  border: 2px solid rgba(0, 0, 0, 0.08) !important;
		  border-radius: 8px !important;
		  overflow: hidden !important;
		  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04) !important;
		}
		
		.cke_top {
		  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
		  border-bottom: 1px solid rgba(0, 0, 0, 0.08) !important;
		}
		
		/* 반응형 개선 */
		@media (max-width: 768px) {
		  .card-body {
		    padding: 20px !important;
		  }
		  
		  .form-group:first-child {
		    padding: 16px !important;
		  }
		  
		  #img_preview {
		    width: 150px !important;
		    height: 150px !important;
		  }
		}
	</style>
	</th:block>
	

	<th:block layout:fragment="content">
	      
	  <div class="container mt-5">
		<div class="row">
			<div class="col">
				<div class="card card-primary">
					<div class="card-header">
					  <h3 class="card-title">상품 등록</h3>
					</div>
					<!-- /.card-header -->
					<!-- form start -->
					<form action="/admin/products/pro_insert" method="post" enctype="multipart/form-data">
					  <div class="card-body">
						<div class="form-group">
							<label>1차카테고리</label> 
							 
							<select class="custom-select" name="cate_prtcode" id="btn_firstCategory"> 
							  <option>1차카테고리 선택</option>						  
							  <option th:each="category : ${cate_list}" th:value="${category.cate_code}" th:text="${category.cate_name}">option 2</option>							  
							</select>
							<label>2차카테고리</label>
							<select class="custom-select" name="cate_code" id="btn_secondCategory">
								<option>2차카테고리 선택</option>	
							</select>
						</div>
						<div class="form-group">
						  <label for="pro_name">상품명</label> 
						  <input type="text" class="form-control" id="pro_name" name="pro_name" placeholder="상품명 입력">
						</div>
						<div class="form-group">
							<label for="pro_price">가격</label>
							<input type="number" class="form-control" id="pro_price" name="pro_price" placeholder="가격 입력">
						  </div>
						  <div class="form-group">
							<label for="pro_discount">할인율</label>
							<input type="number" class="form-control" id="pro_discount" name="pro_discount" placeholder="할인율 입력" min="0" max="100" step="1">
						  </div>
						  <div class="form-group">
							<label for="pro_publisher">제조사</label>
							<input type="text" class="form-control" id="pro_publisher" name="pro_publisher" placeholder="제조사 입력">
						  </div>
						  <div class="form-group">
							<label for="pro_content">상품설명</label>
							<textarea class="form-control" id="pro_summary" name="pro_summary" placeholder="상품설명 입력"></textarea>
						  </div>
						  
						<div class="form-group">
						  <label for="product_img_upload">상품이미지</label>
						  <div class="input-group">
							<div class="custom-file">
							                                               <!-- 바인딩 대상 아님 -->
							  <input type="file" class="custom-file-input" id="product_img_upload" name="product_img_upload">
							  <label class="custom-file-label" for="exampleInputFile">상품이미지파일 선택</label>
							</div>
							<div class="input-group-append">
							  <span class="input-group-text">상품이미지</span>
							</div>
						  </div>					  
						</div>
						<div class="form-group">
							<!-- thumbnail -->
							<label>미리보기 이미지</label>
							<img id="img_preview" style="width: 200px;height: 200px;">
						</div>
						<div class="form-group">
							<label for="pro_amount">수량</label>
							<input type="number" class="form-control" id="pro_amount" name="pro_amount" placeholder="수량 입력">
						  </div>
						<div class="form-group">
							<label for="exampleInputPassword1">판매여부</label><br>

							<!-- 첫 번째 라디오 -->
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="pro_buy" id="pro_buy1" value="Y" checked>
								<label class="form-check-label" for="pro_buy1">판매함</label>
							</div>

							<!-- 두 번째 라디오 -->
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="pro_buy" id="pro_buy2" value="N">
								<label class="form-check-label" for="pro_buy2">판매안함</label>
							</div>
						<div>

					  </div>
					  <!-- /.card-body -->
	  
					  <div class="card-footer">
						<button type="submit" class="btn btn-primary">Submit</button>
					  </div>
					</form>
				  </div>
			</div>
		</div>
	  </div>
	  <script>
		// ckeditor 설정
		var ckeditor_config = {
	             resize_enabled : false,
	             enterMode : CKEDITOR.ENTER_BR,
	             shiftEnterMode : CKEDITOR.ENTER_P,
	             toolbarCanCollapse : true,
	             removePlugins : "elementspath", 
	             //업로드 탭기능추가 속성. CKEditor에서 파일업로드해서 서버로 전송클릭하면 , 이 주소가 동작된다.
	             filebrowserUploadUrl: '/admin/products/imageupload'
	     }
	
		 // id="content" 인 textarea태그에 ckeditor_config변수가 가지고 있는 설정정보를 적용하겠다.
		 CKEDITOR.replace("pro_summary", ckeditor_config);

	</script>
	    
	</th:block>
    
	<!-- JSON (JavaScript Object Notation)시작 -->
	<!-- ajax 시작 --> 
	<!-- jquery  -->
	<th:block layout:fragment="script2">
		<script>
        // 1차 카테고리 시작 26번 라인의 id="btn_firstCategory" 으로 클릭이벤트 입력 
			$(document).ready(function(){
				 
				
				// 1차 카테고리 클릭이벤트 등록.  id="btn_firstCategory"
				$("#btn_firstCategory").on("change", function() {

				let firstCategoryCode = $("#btn_firstCategory").val(); 

				//2차 카테고리  목록을 가져오는 스프링 매핑주소 id="btn_secondCategory"    /admin/categories/secondcategory/1
				let url = "/admin/categories/secondcategory/" + firstCategoryCode; 

				$.getJSON(url, function(secondCategoryList){

					//2차 카테고리 select태그 
					let secondCategoryCode = $("#btn_secondCategory"); 

					let optionHTML = ""; 

					//2차 카테고리 db 갯수만큼 반복 
				 for(let i=0; i<secondCategoryList.length; i++) {  
							// 28번 라인 th:each="category : ${cate_list}" th:value="${category.cate_code}" th:text="${category.cate_name}"
					 optionHTML += "<option value = '" + secondCategoryList[i].cate_code + "'>" + secondCategoryList[i].cate_name + "</option>";
				 }
				
				 secondCategoryCode.find("option").remove(); 
				 secondCategoryCode.append("<option> Select Second Category </option>"); 
				 secondCategoryCode.append(optionHTML); 

				});

			 });

			//thumbnail 
			$("#product_img_upload").on("change",function(e){

				let file = e.target.files[0];

				let scan = new FileReader(); 
				scan.readAsDataURL(file); 
				
				scan.onload = function(e) {
					$("#img_preview").attr("src", e.target.result);
				}

			});
	
		
		
		});
		</script>

	</th:block>
</html>