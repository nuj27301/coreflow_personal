<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layouts/ad_layout}">
<th:block layout:fragment="script1">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</th:block>

<th:block layout:fragment="content">
  <div class="container mt-5">
    <div class="row">
      <div class="col">
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">Ïπ¥ÌÖåÍ≥†Î¶¨ Î©îÎâ¥</h3>
          </div>
                  <!-- Ïπ¥Îìú Î≥∏Î¨∏ -->
          <div class="card-body">
            <div class="row mb-3">

              <!-- 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ -->
              <div class="col-auto d-flex flex-column align-items-stretch" style="flex:1; min-width:300px;">

                <!-- ÏÑ†ÌÉùÏ∞Ω Ï†úÎ™© -->
                <label for="sel-main" class="form-label mb-1">1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨</label>

                <!-- ÏÑ†ÌÉùÏ∞Ω + ÏóÖÎã§Ïö¥ Î≤ÑÌäºÏùÑ ÎÇòÎûÄÌûà Î∞∞Ïπò -->
                <div class="d-flex align-items-stretch">
                  
                  <!-- 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉùÏ∞Ω -->
                  <select 
                    name="cate_code" 
                    class="form-select sel-main" 
                    size="10" 
                    style="width:100%; height:500px;">

                    <!-- 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ù (Thymeleaf Î∞òÎ≥µÎ¨∏) -->
                    <option 
                      th:each="categoryDTO : ${firstCategories}"
                      th:text="${categoryDTO.cate_name}"
                      th:value="${categoryDTO.cate_code}">
                      Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ÅÏö©X
                    </option>
                  </select>

                  <!-- ‚ñ≤ ‚ñº Î≤ÑÌäº -->
                  <div class="d-flex flex-column align-items-center justify-content-center ms-2" style="width:100%;max-width:300px;">
                    <button type="button" class="btn btn-outline-secondary mb-2 btn-up">‚ñ≤</button>
                    <button type="button" class="btn btn-outline-secondary btn-down">‚ñº</button>
                  </div>
                </div>  
                
                <!-- 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ†¨ -->
                <button type="button" id="sFcategory" class="btn btn-success d-block ma-auto mt-3" style="width:100%;max-width:300px;">
                  
                </button> 



                <div class="d-flex justify-content-between mt-2" style="gap:0.5rem;"> 
                  <button type="button" id="add-category" class="btn btn-primary flex-fill">Îì±Î°ù</button>
                  <button type="button" id="edit-category" class="btn btn-warning flex-fill">ÏàòÏ†ï</button>
                  <button type="button" id="delete-category" class="btn btn-danger flex-fill">ÏÇ≠Ï†ú</button>

                </div>
                </div> 
                <div class="col-auto d-flex flex-column align-items-stretch" style="flex:1; min-width:300px;">
                <label for="sel-sub" class="form-label mb-1">2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨</label>
                  <div class="d-flex align-items-stretch">
                <select name="s_category" id="sel-sub" class="form-select" size="10" style="width:100%;height:500px;">                 
                 </select>
                  <!-- ‚ñ≤‚ñº Ïù¥Îèô Î≤ÑÌäº -->
                  <div class="d-flex flex-column align-items-center justify-content-center ms-2" style="gap:0.5rem;">
                    <button type="button" class="btn btn-outline-secondary mb-2 btn-up">‚ñ≤</button>
                    <button type="button" class="btn btn-outline-secondary btn-down">‚ñº</button>
                  </div>
                </div>

                <!-- Ï†ÄÏû• Î≤ÑÌäº -->
                <button type="button" id="ss-category" class="btn btn-success d-block mx-auto mt-3" style="width:100%;max-width:300px;">
                  2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ÄÏû•(Ï†ïÎ†¨)
                </button>

                <!-- Îì±Î°ù/ÏàòÏ†ï/ÏÇ≠Ï†ú -->
                <div class="d-flex justify-content-between mt-2" style="gap:0.5rem;">
                  <button type="button" id="add-second-category" class="btn btn-primary flex-fill">Îì±Î°ù</button>
                  <button type="button" id="edit-second-category" class="btn btn-warning flex-fill">ÏàòÏ†ï</button>
                  <button type="button" id="delete-s-category" class="btn btn-danger flex-fill">ÏÇ≠Ï†ú</button>
                </div>
              </div>
              <!-- ‚úÖ 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏòÅÏó≠ ÎÅù -->

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ü©µ Î™®Îã¨(Modal) Íµ¨Ï°∞ ÏÑ§Î™Ö -->
  <!-- 
  üìò Î™®Îã¨(Modal)Ïù¥ÎûÄ?
  ‚û§ ÏÇ¨Ïö©ÏûêÍ∞Ä Î≥ÑÎèÑ ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌïòÏßÄ ÏïäÍ≥†, ÌôîÎ©¥ ÏúÑÏóê ‚ÄòÎåÄÌôîÏÉÅÏûê‚ÄôÎ•º ÎùÑÏõåÏÑú ÏûÖÎ†•/ÌôïÏù∏/ÏàòÏ†ïÏùÑ ÏàòÌñâÌïòÍ≤å ÌïòÎäî UI.
  ‚û§ BootstrapÏóêÏÑú Ï†úÍ≥µÌïòÎäî ÌåùÏóÖÏ∞Ω Íµ¨ÏÑ± ÏöîÏÜå.
  ‚û§ Î™®Îã¨Ï∞ΩÏùÄ .modal, .modal-dialog, .modal-content Íµ¨Ï°∞Î•º Î∞òÎìúÏãú Ìè¨Ìï®Ìï¥Ïïº ÏûëÎèôÌï®.
  -->


  <!-- ü©∑ 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù Î™®Îã¨ -->
  <div class="modal fade" id="FCModal" tabindex="-1" aria-labelledby="FCMLabel" aria-hidden="true">
    <!-- 
    class="modal fade" ‚û§ Bootstrap Î™®Îã¨ ÌåùÏóÖ Ï∞Ω Ï†ïÏùò
    fade ‚û§ Î∂ÄÎìúÎüΩÍ≤å Îì±Ïû•ÌïòÎäî Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
    id="firstCategoryModal" ‚û§ JSÎ°ú Ï†úÏñ¥Ìï† Îïå ÏÇ¨Ïö©ÎêòÎäî ÏãùÎ≥ÑÏûê
    tabindex="-1" ‚û§ Ìè¨Ïª§Ïä§ Ï†úÏñ¥ (Î™®Îã¨ Î∞îÍπ• ÌÅ¥Î¶≠ Ïãú ÌÇ§Î≥¥Îìú Ìè¨Ïª§Ïä§ Î∞©ÏßÄ)
    aria-labelledby / aria-hidden ‚û§ Ïõπ Ï†ëÍ∑ºÏÑ±(‚òÖÏû•Ïï†Ïù∏ Ï†ëÍ∑ºÏÑ±) ÏÜçÏÑ±
    -->

    <div class="modal-dialog modal-dialog-centered">
      <!-- modal-dialog-centered ‚û§ ÏàòÏßÅ Ï§ëÏïô Ï†ïÎ†¨ -->
      <div class="modal-content rounded-3 shadow-sm">
        <!-- modal-content ‚û§ Î™®Îã¨Ïùò Ï†ÑÏ≤¥ ÎÇ¥Ïö© Î∞ïÏä§ -->

        <!-- üß° Î™®Îã¨ Ìó§Îçî -->
        <div class="modal-header border-0">
          <h5 class="modal-title fw-bold" id="firstCategoryModalLabel">1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Îã´Í∏∞"></button>
          <!-- 
          data-bs-dismiss="modal" ‚û§ Bootstrap ÏÜçÏÑ±
          ‚û§ ÌÅ¥Î¶≠ Ïãú Î™®Îã¨ ÏûêÎèô Îã´Ìûò
          -->

        </div>

        <!-- üß° Î™®Îã¨ Î∞îÎîî (ÏûÖÎ†•Ìèº ÏòÅÏó≠) -->
        <div class="modal-body">
          <form id="firstCategoryForm">
            <!-- form : ÏÑúÎ≤ÑÎ°ú Îç∞Ïù¥ÌÑ∞ Ï†ÑÎã¨Ïö© ÏûÖÎ†• Ìèº -->
            <div class="mb-3">
              <label for="categoryName" class="form-label">Ïπ¥ÌÖåÍ≥†Î¶¨Î™Ö</label>
              <input type="hidden" id="categoryCode">
              <!-- 
              hidden : ÏÇ¨Ïö©ÏûêÏóêÍ≤ê Ïïà Î≥¥Ïù¥ÏßÄÎßå JSÎÇò ÏÑúÎ≤ÑÏ†ÑÏÜ° Ïãú ÏÇ¨Ïö© Í∞ÄÎä• (Ïòà: ÏàòÏ†ï Ïãú Í∏∞Ï°¥ ÏΩîÎìú Î≥¥Í¥Ä)
              -->

              <input type="text" class="form-control" id="categoryName" name="categoryName" placeholder="Ïπ¥ÌÖåÍ≥†Î¶¨Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
              <!-- 
              class="form-control" ‚û§ Bootstrap Í∏∞Î≥∏ ÏûÖÎ†• ÏÉÅÏûê Ïä§ÌÉÄÏùº
              name="categoryName" ‚û§ ÏÑúÎ≤ÑÎ°ú Ï†ÑÎã¨Îê† key (ControllerÎÇò DTO ÌïÑÎìúÎ™ÖÍ≥º Î∞òÎìúÏãú ÏùºÏπò)
              placeholder ‚û§ ÏûÖÎ†• ÏòàÏãú Î¨∏Íµ¨
              required ‚û§ ÌïÑÏàò ÏûÖÎ†• ÌïÑÎìú (ÎπÑÏõåÎëêÎ©¥ Ï†úÏ∂ú Ïïà Îê®)
              -->
            </div>
          </form>
        </div>

        <!-- üß° Î™®Îã¨ Ìë∏ÌÑ∞ (Î≤ÑÌäº ÏòÅÏó≠) -->
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ï∑®ÏÜå</button>
          <button type="button" id="btn_plus_category" class="btn btn-primary">Îì±Î°ù</button>
          <button type="button" id="btn_modify_category" class="btn btn-primary" style="display:none;">ÏàòÏ†ï</button>
        </div>
      </div>
    </div>
  </div>


  <!-- üíô 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù/ÏàòÏ†ï Î™®Îã¨ -->
  <div class="modal fade" id="sCGModal" tabindex="-1" aria-labelledby="scModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-3 shadow-sm">

        <!-- Ìó§Îçî -->
        <div class="modal-header border-0">
          <h5 class="modal-title fw-bold" id="sCMLl">2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Îã´Í∏∞"></button>
        </div>

        <!-- Î≥∏Î¨∏ -->
        <div class="modal-body">
          <form id="categoryForm">

            <!-- ü©∑ 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù -->
            <div class="mb-3">
              <label for="sMCategory" class="form-label">1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù</label>
              <select class="form-select" id="ssMCategory" name="firstCategory">
                <!-- 
                name="firstCategory" ‚û§ ÏÑúÎ≤ÑÎ°ú Ï†ÑÎã¨ Ïãú key Ïù¥Î¶Ñ
                Controller ÎòêÎäî DTOÏóêÏÑú firstCategory Î≥ÄÏàòÎ™ÖÍ≥º ÏùºÏπòÌï¥Ïïº Ìï®
                -->
                <option value="">-- 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù --</option>
                <!-- JSÎ°ú ÏÑúÎ≤ÑÏùò 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ùÏùÑ append Í∞ÄÎä• -->
              </select>
            </div>

            <!-- ü©µ 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏûÖÎ†• -->
            <div class="mb-3">
              <label for="secondCategoryName" class="form-label">2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨Î™Ö</label>
              <input type="hidden" id="secondCategoryCode">
              <input type="text" class="form-control" id="sCN" name="sCN" placeholder="2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" required>
              <!-- 
              name="secondCategoryName"
              ‚û§ ControllerÎÇò DTOÏùò Î≥ÄÏàòÎ™ÖÍ≥º Î∞òÎìúÏãú ÏùºÏπòÌï¥Ïïº Ìï®.
              Ïòà)
                @RequestParam("secondCategoryName") String name
                ÎòêÎäî DTO ÌïÑÎìú private String secondCategoryName;
              -->
            </div>

          </form>
        </div>

        <!-- Ìë∏ÌÑ∞ -->
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ï∑®ÏÜå</button>
          <button type="button" id="btn_add_secondCategory" class="btn btn-primary">Îì±Î°ù</button>
          <button type="button" id="btn_e_secondCategory" class="btn btn-primary" style="display:none;">ÏàòÏ†ï</button>
        </div>

      </div>
    </div>
  </div>
</th:block>
                    </div>
</div>


</th:block>

<th:block layout:fragment="script2">
<script> 
$(function(){

  $("select[name='cate_code']").on("change",function(){
    let current=$(this); 
    
    let firCategory = current.val(); 

    $.ajax({

      url: '/admin/category/secondpCategoryList/' + firstCategory,// Î∏åÎùºÏö∞Ï†Ä Ï∂úÎ†•
      type: 'get', 
      dataType: 'json',
      success: function(data) {
        let adCategoryStr = ""; 
        for(let i=0; i<data.length; i++){
          adCategoryStr +=`<option value = "${data[i].cate_code}">${data[i].cate_name}</option>`;
        }  

        $("select[name='s_category']").empty(); 
       $("select[name='s_category']").append(adCategoryStr);
      }
    });  

    // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏÑú Î≥ÄÍ≤Ω 
    function moveUp($select){
      $select.find('option:select').each(function(){
        let $next = $(this).next('option'); 
        if($next.length){
          $(this).insertAfter($next);
        }
      });
     
        // ‚ñ≤Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú moveUp Ïã§Ìñâ
  $('.btn-up').on('click', function() {
    // .closest() : Í∞ÄÏû• Í∞ÄÍπåÏö¥ ÏÉÅÏúÑÏöîÏÜå Ï§ë Ï°∞Í±¥Í≥º ÏùºÏπòÌïòÎäî ÏöîÏÜåÎ•º Ï∞æÏùå
    // selectÎ•º Ï∞æÏïÑ moveUp Ìï®Ïàò Ïã§Ìñâ
    var $select = $(this).closest('.col-auto, .d-flex.flex-column.align-items-stretch, .d-flex.align-items-stretch').find('select');
    moveUp($select);
  });

  // ‚ñºÎ≤ÑÌäº ÌÅ¥Î¶≠ Ïãú moveDown Ïã§Ìñâ
  $('.btn-down').on('click', function() {
    var $select = $(this).closest('.col-auto, .d-flex.flex-column.align-items-stretch, .d-flex.align-items-stretch').find('select');
    moveDown($select);
  });

  
  
    } 

      $('#sFcategory').on('click', function() {
    let orderArr = [];  // ÏàúÏÑúÎ•º Ï†ÄÏû•Ìï† Î∞∞Ïó¥

    // Í∞Å optionÏùò value(cate_code)Î•º ÏàúÏÑúÎåÄÎ°ú Î∞∞Ïó¥Ïóê push
    $('#sel-main option').each(function() {
      orderArr.push($(this).val());
    });

    // AJAXÎ°ú ÏÑúÎ≤ÑÏóê Ï†ÑÏÜ°
    $.ajax({
      url: '/admin/category/categorySort',
      type: 'post',
      data: {orderArr : orderArr},  // Ï†ÑÎã¨ Îç∞Ïù¥ÌÑ∞ (Î∞∞Ïó¥)
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ†¨ÏôÑÎ£å");
        }
      },
      error : function(xhr, status, error) {
        alert("ÏóêÎü¨ Î∞úÏÉù: " + error);
      }
    });

    alert('1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏÑúÍ∞Ä Ï†ÄÏû•:\n' + orderArr.join(', '));
  });

/* ------------------------- [ 4Ô∏è‚É£ 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏÑú Ï†ÄÏû• ] ------------------------- */
  $('#ss-category').on('click', function() {
    let orderArr = [];
    $('#sel-sub option').each(function() {
      orderArr.push($(this).val());
    });
    
    $.ajax({
        url: '/admin/category/categorySort',
        type: 'post',
        data: {orderArr : orderArr},
        dataType: 'text',
        success : function(result) {
          if(result == "success") {
            alert("2Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ†¨Îê®");
          }
        },
        error : function(xhr, status, error) {
          alert("ÏóêÎü¨ Î∞úÏÉù: " + error);
        }
      });

    alert('2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàúÏÑúÍ∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§:\n' + orderArr.join(', '));
  });


  /* ------------------------- [ 5Ô∏è‚É£ 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù Î™®Îã¨Ï∞Ω ] ------------------------- */
  const myModal = new bootstrap.Modal('#FCModal', { keyboard: false });
  // bootstrap.Modal : Î∂ÄÌä∏Ïä§Ìä∏Îû©Ïùò Î™®Îã¨Ï∞Ω(ÌåùÏóÖÏ∞Ω) Í∞ùÏ≤¥ ÏÉùÏÑ±

  $("button#add-category").on("click", function() {
    $("#FCMLabel").html("1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù");
    $("#btn_plus_category").show();   // Îì±Î°ù Î≤ÑÌäº Î≥¥Ïù¥Í∏∞
    $("#btn_edit_category").hide();  // ÏàòÏ†ï Î≤ÑÌäº Ïà®Í∏∞Í∏∞
    myModal.show();                  // Î™®Îã¨Ï∞Ω Ïó¥Í∏∞
  });

  // 1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïã§Ìñâ
  $("button#btn_plus_category").on("click", function() {
    let categoryName = $("#categoryName").val().trim(); // ÏûÖÎ†•Í∞í ÏùΩÍ∏∞
    if (categoryName === "") {
      alert("Ïπ¥ÌÖåÍ≥†Î¶¨Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }

    // Îì±Î°ù AJAX ÏöîÏ≤≠
    $.ajax({
      url: "/admin/category/addFirstCategory",
      type: "POST",
      data: { cate_name: categoryName },
      dataType: "text",
      success: function(result) {
        if (result == "success") {
          $("#FCModal").modal("hide"); // Î™®Îã¨ Îã´Í∏∞
          $("#categoryName").val("");             // ÏûÖÎ†•Í∞í Ï¥àÍ∏∞Ìôî
          alert("1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.");
          location.href = "/admin/category/categorymenu"; // ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®
        }
      },
      error: function(xhr, status, error) {
        alert("Îì±Î°ù Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
      }
    });
   });


  /* ------------------------- [ 6Ô∏è‚É£ 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàòÏ†ï ] ------------------------- */
   $("button#edit-category").on("click", function() {
    if ($("#sel-main option:selected").length === 0) {
      alert("1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
      return;
    }

    // ÏÑ†ÌÉùÎêú Ïπ¥ÌÖåÍ≥†Î¶¨ Ï†ïÎ≥¥ Î™®Îã¨Ïóê Ï±ÑÏõåÎÑ£Í∏∞
    $("#categoryName").val($("#sel-main option:selected").text());
    $("#categoryCode").val($("#sel-main option:selected").val());

    $("#firstCategoryModalLabel").html("1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàòÏ†ï");
    $("#btn_plus_category").hide();
    $("#btn_modify_category").show();

    myModal.show(); // ÏàòÏ†ïÏö© Î™®Îã¨ Ïó¥Í∏∞
   });

   // ÏàòÏ†ï Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïã§Ï†ú ÏàòÏ†ï ÏöîÏ≤≠
   $("#btn_modify_category").on("click", function() {
      $.ajax({
        url: "/admin/category/editFirstCategory",
        type: "POST",
        data: { cate_code : $("#categoryCode").val(),  cate_name: $("#categoryName").val() },
        dataType: "text",
        success: function(result) {
          if (result == "success") {
            $("#firstCategoryModal").modal("hide");
            $("#categoryName").val("");
            alert("Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.");
            location.href = "/admin/category/categorymenu";
          }
        },
        error: function(xhr, status, error) {
          alert("Îì±Î°ù Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
        }
    });
   });



  /* ------------------------- [ 7Ô∏è‚É£ 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù/ÏàòÏ†ï/ÏÇ≠Ï†ú ] ------------------------- */

   const myModal2 = new bootstrap.Modal('#sCGModal', { keyboard: false });

   // 2Ï∞® Îì±Î°ù Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïã§Ìñâ
   $("#add-second-category").on("click", function() {
    $.ajax({
      url: '/admin/category/firstCategoryList',  // 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ù Î∂àÎü¨Ïò§Í∏∞
      type: 'get',
      dataType: 'json',
      success: function(data) {
        let firstCategoryStr = "";
        for(let i=0; i<data.length; i++) {
          firstCategoryStr += `<option value="${data[i].cate_code}">${data[i].cate_name}</option>`;
        }

        $("select#ssMCategory").empty();
        $("select#ssMCategory").append("<option value=''>1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù</option>");
        $("select#ssMCategory").append(firstCategoryStr);

        $("#btn_plus_secondCategory").show();
        $("#btn_modify_secondCategory").hide();
      }
    });
    myModal2.show(); // 2Ï∞® Îì±Î°ù Î™®Îã¨ Ïó¥Í∏∞
   });


   // 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ Îì±Î°ù Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïã§Ìñâ
   $("button#btn_add_secondCategory").on("click", function() {

    let selMainCategory = $("#sMCategory");
    if(selMainCategory.val() == "") {
      alert("1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨Î™ÖÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
      return;
    }

    let secondCategoryName = $("#sCN").val().trim();
    if (secondCategoryName === "") {
      alert("2Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }

    $.ajax({
      url: "/admin/category/addSecondCategory",
      type: "POST",
      data: { cate_prtcode : $("#selMainCategory").val(), cate_name: $("#sCN").val() },
      dataType: "text",
      success: function(result) {
        if (result == "success") {
          $("#sCGModal").modal("hide");
          $("#sCN").val("");
          alert("2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("Îì±Î°ù Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
      }
    });
   });


   // 2Ï∞® ÏàòÏ†ï Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ‚Äî ÏàòÏ†ï Î™®Îã¨ Ï§ÄÎπÑ
   $("#edit-second-category").on("click", function() {
    let firstCateCode = $("#sel-main option:selected").val();
    let secondCateCode = $("#sel-sub option:selected").val();
    let secondCateName = $("#sel-sub option:selected").html();

    if ($("#sel-sub option:selected").length === 0) {
      alert("1Ï∞®, 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
      return;
    }

    // ÏàòÏ†ïÏö© Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
    $.ajax({
      url: '/admin/category/firstCategoryList',
      type: 'get',
      dataType: 'json',
      success: function(data) {
        let firstCategoryStr = "";
        for(let i=0; i<data.length; i++) {
          firstCategoryStr += `<option value="${data[i].cate_code}" ${firstCateCode == data[i].cate_code ? 'selected' : ''} >${data[i].cate_name}</option>`;
        }

        $("#sCGModal").html("2Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàòÏ†ï");
        $("select#selMainCategory").empty();
        $("select#selMainCategory").append("<option value=''>1Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù</option>");
        $("select#selMainCategory").append(firstCategoryStr);

        $("#secondCategoryCode").val(secondCateCode);
        $("#sCN").val(secondCateName);

        $("#btn_add_secondCategory").hide();
        $("#btn_e_secondCategory").show();

        myModal2.show();
      }
    });
   });


   // 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏàòÏ†ï Ï†ÄÏû•
   $("#btn_e_secondCategory").on("click", function() {
    $.ajax({
        url: "/admin/category/editSecondCategory",
        type: "POST",
        data: { cate_code : $("#secondCategoryCode").val(),
                cate_name: $("#sCN").val(),
                cate_prtcode :  $("#selMainCategory").val()},
        dataType: "text",
        success: function(result) {
          if (result == "success") {
            $("#sCGModal").modal("hide");
            $("#sCN").val("");
            $("#secondCategoryCode").val("");
            alert("2Ï∞®Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÏàòÏ†ïÏôÑÎ£å.");
            location.href = "/admin/category/categorymenu";
          }
        },
        error: function(xhr, status, error) {
          alert("Îì±Î°ù Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
        }
    });
   });


   // 1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÇ≠Ï†ú
   $("button#delete-category").on("click", function() {
    if($("select#sel-main option:selected").length == 0) {
      alert("1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
      return;    
    }

    let cate_code = $("select#sel-main option:selected").val();

    $.ajax({
      url: '/admin/category/deleteCategory',
      type: 'post',
      data: {cate_code : cate_code},
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("1Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÇ≠Ï†úÎê®");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("ÏÇ≠Ï†ú Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
      }
    });
   });


   // 2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÇ≠Ï†ú
   $("button#delete-s-category").on("click", function() {
    if($("select#sel-sub option:selected").length == 0) {
      alert("2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.");
      return;    
    }

    let cate_code = $("select#sel-sub option:selected").val();

    $.ajax({
      url: '/admin/category/deleteCategory',
      type: 'post',
      data: {cate_code : cate_code},
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("2Ï∞® Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÇ≠Ï†úÏôÑÎ£å");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("ÏÇ≠Ï†ú Ï§ë Ïò§Î•ò Î∞úÏÉù: " + error);
      }
    });
   });

}); // ‚úÖ jQuery ready ÎÅù
});


</script>
</th:block>

</html>









