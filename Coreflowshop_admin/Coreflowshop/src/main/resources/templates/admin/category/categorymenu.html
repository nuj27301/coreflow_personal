<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{admin/layouts/ad_layout}">
<th:block layout:fragment="script1">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</th:block>

<th:block layout:fragment="content">
  <div class="container mt-5">
    <div class="row">
      <div class="col">
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">ì¹´í…Œê³ ë¦¬ ë©”ë‰´</h3>
          </div>
                  <!-- ì¹´ë“œ ë³¸ë¬¸ -->
          <div class="card-body">
            <div class="row mb-3">

              <!-- 1ì°¨ ì¹´í…Œê³ ë¦¬ -->
              <div class="col-auto d-flex flex-column align-items-stretch" style="flex:1; min-width:300px;">

                <!-- ì„ íƒì°½ ì œëª© -->
                <label for="sel-main" class="form-label mb-1">1ì°¨ ì¹´í…Œê³ ë¦¬</label>

                <!-- ì„ íƒì°½ + ì—…ë‹¤ìš´ ë²„íŠ¼ì„ ë‚˜ë€íˆ ë°°ì¹˜ -->
                <div class="d-flex align-items-stretch">
                  
                  <!-- 1ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒì°½ -->
                  <select 
                    name="cate_code" 
                    class="form-select sel-main" 
                    size="10" 
                    style="width:100%; height:500px;">

                    <!-- 1ì°¨ ì¹´í…Œê³ ë¦¬ ëª©ë¡ (Thymeleaf ë°˜ë³µë¬¸) -->
                    <option 
                      th:each="categoryDTO : ${firstCategories}"
                      th:text="${categoryDTO.cate_name}"
                      th:value="${categoryDTO.cate_code}">
                      ì¹´í…Œê³ ë¦¬ ì ìš©X
                    </option>
                  </select>

                  <!-- â–² â–¼ ë²„íŠ¼ -->
                  <div class="d-flex flex-column align-items-center justify-content-center ms-2" style="width:100%;max-width:300px;">
                    <button type="button" class="btn btn-outline-secondary mb-2 btn-up">â–²</button>
                    <button type="button" class="btn btn-outline-secondary btn-down">â–¼</button>
                  </div>
                </div>  
                
                <!-- 1ì°¨ ì¹´í…Œê³ ë¦¬ ì •ë ¬ -->
                <button type="button" id="sFcategory" class="btn btn-success d-block ma-auto mt-3" style="width:100%;max-width:300px;">
                  
                </button> 



                <div class="d-flex justify-content-between mt-2" style="gap:0.5rem;"> 
                  <button type="button" id="add-category" class="btn btn-primary flex-fill">ë“±ë¡</button>
                  <button type="button" id="edit-category" class="btn btn-warning flex-fill">ìˆ˜ì •</button>
                  <button type="button" id="delete-category" class="btn btn-danger flex-fill">ì‚­ì œ</button>

                </div>
                </div> 
                <div class="col-auto d-flex flex-column align-items-stretch" style="flex:1; min-width:300px;">
                <label for="sel-sub" class="form-label mb-1">2ì°¨ ì¹´í…Œê³ ë¦¬</label>
                  <div class="d-flex align-items-stretch">
                <select name="s_category" id="sel-sub" class="form-select" size="10" style="width:100%;height:500px;">                 
                 </select>
                  <!-- â–²â–¼ ì´ë™ ë²„íŠ¼ -->
                  <div class="d-flex flex-column align-items-center justify-content-center ms-2" style="gap:0.5rem;">
                    <button type="button" class="btn btn-outline-secondary mb-2 btn-up">â–²</button>
                    <button type="button" class="btn btn-outline-secondary btn-down">â–¼</button>
                  </div>
                </div>

                <!-- ì €ì¥ ë²„íŠ¼ -->
                <button type="button" id="ss-category" class="btn btn-success d-block mx-auto mt-3" style="width:100%;max-width:300px;">
                  2ì°¨ ì¹´í…Œê³ ë¦¬ ì €ì¥(ì •ë ¬)
                </button>

                <!-- ë“±ë¡/ìˆ˜ì •/ì‚­ì œ -->
                <div class="d-flex justify-content-between mt-2" style="gap:0.5rem;">
                  <button type="button" id="add-second-category" class="btn btn-primary flex-fill">ë“±ë¡</button>
                  <button type="button" id="edit-second-category" class="btn btn-warning flex-fill">ìˆ˜ì •</button>
                  <button type="button" id="delete-s-category" class="btn btn-danger flex-fill">ì‚­ì œ</button>
                </div>
              </div>
              <!-- âœ… 2ì°¨ ì¹´í…Œê³ ë¦¬ ì˜ì—­ ë -->

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ğŸ©µ ëª¨ë‹¬(Modal) êµ¬ì¡° ì„¤ëª… -->
  <!-- 
  ğŸ“˜ ëª¨ë‹¬(Modal)ì´ë€?
  â¤ ì‚¬ìš©ìê°€ ë³„ë„ í˜ì´ì§€ë¡œ ì´ë™í•˜ì§€ ì•Šê³ , í™”ë©´ ìœ„ì— â€˜ëŒ€í™”ìƒìâ€™ë¥¼ ë„ì›Œì„œ ì…ë ¥/í™•ì¸/ìˆ˜ì •ì„ ìˆ˜í–‰í•˜ê²Œ í•˜ëŠ” UI.
  â¤ Bootstrapì—ì„œ ì œê³µí•˜ëŠ” íŒì—…ì°½ êµ¬ì„± ìš”ì†Œ.
  â¤ ëª¨ë‹¬ì°½ì€ .modal, .modal-dialog, .modal-content êµ¬ì¡°ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ ì‘ë™í•¨.
  -->


  <!-- ğŸ©· 1ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡ ëª¨ë‹¬ -->
  <div class="modal fade" id="FCModal" tabindex="-1" aria-labelledby="FCMLabel" aria-hidden="true">
    <!-- 
    class="modal fade" â¤ Bootstrap ëª¨ë‹¬ íŒì—… ì°½ ì •ì˜
    fade â¤ ë¶€ë“œëŸ½ê²Œ ë“±ì¥í•˜ëŠ” ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
    id="firstCategoryModal" â¤ JSë¡œ ì œì–´í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì‹ë³„ì
    tabindex="-1" â¤ í¬ì»¤ìŠ¤ ì œì–´ (ëª¨ë‹¬ ë°”ê¹¥ í´ë¦­ ì‹œ í‚¤ë³´ë“œ í¬ì»¤ìŠ¤ ë°©ì§€)
    aria-labelledby / aria-hidden â¤ ì›¹ ì ‘ê·¼ì„±(â˜…ì¥ì• ì¸ ì ‘ê·¼ì„±) ì†ì„±
    -->

    <div class="modal-dialog modal-dialog-centered">
      <!-- modal-dialog-centered â¤ ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ -->
      <div class="modal-content rounded-3 shadow-sm">
        <!-- modal-content â¤ ëª¨ë‹¬ì˜ ì „ì²´ ë‚´ìš© ë°•ìŠ¤ -->

        <!-- ğŸ§¡ ëª¨ë‹¬ í—¤ë” -->
        <div class="modal-header border-0">
          <h5 class="modal-title fw-bold" id="firstCategoryModalLabel">1ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
          <!-- 
          data-bs-dismiss="modal" â¤ Bootstrap ì†ì„±
          â¤ í´ë¦­ ì‹œ ëª¨ë‹¬ ìë™ ë‹«í˜
          -->

        </div>

        <!-- ğŸ§¡ ëª¨ë‹¬ ë°”ë”” (ì…ë ¥í¼ ì˜ì—­) -->
        <div class="modal-body">
          <form id="firstCategoryForm">
            <!-- form : ì„œë²„ë¡œ ë°ì´í„° ì „ë‹¬ìš© ì…ë ¥ í¼ -->
            <div class="mb-3">
              <label for="categoryName" class="form-label">ì¹´í…Œê³ ë¦¬ëª…</label>
              <input type="hidden" id="categoryCode">
              <!-- 
              hidden : ì‚¬ìš©ìì—ê² ì•ˆ ë³´ì´ì§€ë§Œ JSë‚˜ ì„œë²„ì „ì†¡ ì‹œ ì‚¬ìš© ê°€ëŠ¥ (ì˜ˆ: ìˆ˜ì • ì‹œ ê¸°ì¡´ ì½”ë“œ ë³´ê´€)
              -->

              <input type="text" class="form-control" id="categoryName" name="categoryName" placeholder="ì¹´í…Œê³ ë¦¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" required>
              <!-- 
              class="form-control" â¤ Bootstrap ê¸°ë³¸ ì…ë ¥ ìƒì ìŠ¤íƒ€ì¼
              name="categoryName" â¤ ì„œë²„ë¡œ ì „ë‹¬ë  key (Controllerë‚˜ DTO í•„ë“œëª…ê³¼ ë°˜ë“œì‹œ ì¼ì¹˜)
              placeholder â¤ ì…ë ¥ ì˜ˆì‹œ ë¬¸êµ¬
              required â¤ í•„ìˆ˜ ì…ë ¥ í•„ë“œ (ë¹„ì›Œë‘ë©´ ì œì¶œ ì•ˆ ë¨)
              -->
            </div>
          </form>
        </div>

        <!-- ğŸ§¡ ëª¨ë‹¬ í‘¸í„° (ë²„íŠ¼ ì˜ì—­) -->
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
          <button type="button" id="btn_plus_category" class="btn btn-primary">ë“±ë¡</button>
          <button type="button" id="btn_modify_category" class="btn btn-primary" style="display:none;">ìˆ˜ì •</button>
        </div>
      </div>
    </div>
  </div>


  <!-- ğŸ’™ 2ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬ -->
  <div class="modal fade" id="sCGModal" tabindex="-1" aria-labelledby="scModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-3 shadow-sm">

        <!-- í—¤ë” -->
        <div class="modal-header border-0">
          <h5 class="modal-title fw-bold" id="sCMLl">2ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
        </div>

        <!-- ë³¸ë¬¸ -->
        <div class="modal-body">
          <form id="categoryForm">

            <!-- ğŸ©· 1ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
            <div class="mb-3">
              <label for="sMCategory" class="form-label">1ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒ</label>
              <select class="form-select" id="ssMCategory" name="firstCategory">
                <!-- 
                name="firstCategory" â¤ ì„œë²„ë¡œ ì „ë‹¬ ì‹œ key ì´ë¦„
                Controller ë˜ëŠ” DTOì—ì„œ firstCategory ë³€ìˆ˜ëª…ê³¼ ì¼ì¹˜í•´ì•¼ í•¨
                -->
                <option value="">-- 1ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒ --</option>
                <!-- JSë¡œ ì„œë²„ì˜ 1ì°¨ ì¹´í…Œê³ ë¦¬ ëª©ë¡ì„ append ê°€ëŠ¥ -->
              </select>
            </div>

            <!-- ğŸ©µ 2ì°¨ ì¹´í…Œê³ ë¦¬ ì…ë ¥ -->
            <div class="mb-3">
              <label for="secondCategoryName" class="form-label">2ì°¨ ì¹´í…Œê³ ë¦¬ëª…</label>
              <input type="hidden" id="secondCategoryCode">
              <input type="text" class="form-control" id="sCN" name="sCN" placeholder="2ì°¨ ì¹´í…Œê³ ë¦¬ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" required>
              <!-- 
              name="secondCategoryName"
              â¤ Controllerë‚˜ DTOì˜ ë³€ìˆ˜ëª…ê³¼ ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼ í•¨.
              ì˜ˆ)
                @RequestParam("secondCategoryName") String name
                ë˜ëŠ” DTO í•„ë“œ private String secondCategoryName;
              -->
            </div>

          </form>
        </div>

        <!-- í‘¸í„° -->
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
          <button type="button" id="btn_add_secondCategory" class="btn btn-primary">ë“±ë¡</button>
          <button type="button" id="btn_e_secondCategory" class="btn btn-primary" style="display:none;">ìˆ˜ì •</button>
        </div>

      </div>
    </div>
  </div>
</th:block>
                    </div>
</div>


</th:block>

<th:block layout:fragment="script2">
<script> 
$(function(){

  $("select[name='cate_code']").on("change",function(){
    let current=$(this); 
    
    let firCategory = current.val(); 

    $.ajax({

      url: '/admin/category/secondpCategoryList/' + firstCategory,// ë¸Œë¼ìš°ì € ì¶œë ¥
      type: 'get', 
      dataType: 'json',
      success: function(data) {
        let adCategoryStr = ""; 
        for(let i=0; i<data.length; i++){
          adCategoryStr +=`<option value = "${data[i].cate_code}">${data[i].cate_name}</option>`;
        }  

        $("select[name='s_category']").empty(); 
       $("select[name='s_category']").append(adCategoryStr);
      }
    });  

    // ì¹´í…Œê³ ë¦¬ ìˆœì„œ ë³€ê²½ 
    function moveUp($select){
      $select.find('option:select').each(function(){
        let $next = $(this).next('option'); 
        if($next.length){
          $(this).insertAfter($next);
        }
      });
     
        // â–²ë²„íŠ¼ í´ë¦­ ì‹œ moveUp ì‹¤í–‰
  $('.btn-up').on('click', function() {
    // .closest() : ê°€ì¥ ê°€ê¹Œìš´ ìƒìœ„ìš”ì†Œ ì¤‘ ì¡°ê±´ê³¼ ì¼ì¹˜í•˜ëŠ” ìš”ì†Œë¥¼ ì°¾ìŒ
    // selectë¥¼ ì°¾ì•„ moveUp í•¨ìˆ˜ ì‹¤í–‰
    var $select = $(this).closest('.col-auto, .d-flex.flex-column.align-items-stretch, .d-flex.align-items-stretch').find('select');
    moveUp($select);
  });

  // â–¼ë²„íŠ¼ í´ë¦­ ì‹œ moveDown ì‹¤í–‰
  $('.btn-down').on('click', function() {
    var $select = $(this).closest('.col-auto, .d-flex.flex-column.align-items-stretch, .d-flex.align-items-stretch').find('select');
    moveDown($select);
  });

  
  
    } 

      $('#sFcategory').on('click', function() {
    let orderArr = [];  // ìˆœì„œë¥¼ ì €ì¥í•  ë°°ì—´

    // ê° optionì˜ value(cate_code)ë¥¼ ìˆœì„œëŒ€ë¡œ ë°°ì—´ì— push
    $('#sel-main option').each(function() {
      orderArr.push($(this).val());
    });

    // AJAXë¡œ ì„œë²„ì— ì „ì†¡
    $.ajax({
      url: '/admin/category/categorySort',
      type: 'post',
      data: {orderArr : orderArr},  // ì „ë‹¬ ë°ì´í„° (ë°°ì—´)
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("1ì°¨ì¹´í…Œê³ ë¦¬ ì •ë ¬ì™„ë£Œ");
        }
      },
      error : function(xhr, status, error) {
        alert("ì—ëŸ¬ ë°œìƒ: " + error);
      }
    });

    alert('1ì°¨ ì¹´í…Œê³ ë¦¬ ìˆœì„œê°€ ì €ì¥:\n' + orderArr.join(', '));
  });

/* ------------------------- [ 4ï¸âƒ£ 2ì°¨ ì¹´í…Œê³ ë¦¬ ìˆœì„œ ì €ì¥ ] ------------------------- */
  $('#ss-category').on('click', function() {
    let orderArr = [];
    $('#sel-sub option').each(function() {
      orderArr.push($(this).val());
    });
    
    $.ajax({
        url: '/admin/category/categorySort',
        type: 'post',
        data: {orderArr : orderArr},
        dataType: 'text',
        success : function(result) {
          if(result == "success") {
            alert("2ì°¨ì¹´í…Œê³ ë¦¬ ì •ë ¬ë¨");
          }
        },
        error : function(xhr, status, error) {
          alert("ì—ëŸ¬ ë°œìƒ: " + error);
        }
      });

    alert('2ì°¨ ì¹´í…Œê³ ë¦¬ ìˆœì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤:\n' + orderArr.join(', '));
  });


  /* ------------------------- [ 5ï¸âƒ£ 1ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡ ëª¨ë‹¬ì°½ ] ------------------------- */
  const myModal = new bootstrap.Modal('#FCModal', { keyboard: false });
  // bootstrap.Modal : ë¶€íŠ¸ìŠ¤íŠ¸ë©ì˜ ëª¨ë‹¬ì°½(íŒì—…ì°½) ê°ì²´ ìƒì„±

  $("button#add-category").on("click", function() {
    $("#FCMLabel").html("1ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡");
    $("#btn_plus_category").show();   // ë“±ë¡ ë²„íŠ¼ ë³´ì´ê¸°
    $("#btn_edit_category").hide();  // ìˆ˜ì • ë²„íŠ¼ ìˆ¨ê¸°ê¸°
    myModal.show();                  // ëª¨ë‹¬ì°½ ì—´ê¸°
  });

  // 1ì°¨ì¹´í…Œê³ ë¦¬ ë“±ë¡ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
  $("button#btn_plus_category").on("click", function() {
    let categoryName = $("#categoryName").val().trim(); // ì…ë ¥ê°’ ì½ê¸°
    if (categoryName === "") {
      alert("ì¹´í…Œê³ ë¦¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    // ë“±ë¡ AJAX ìš”ì²­
    $.ajax({
      url: "/admin/category/addFirstCategory",
      type: "POST",
      data: { cate_name: categoryName },
      dataType: "text",
      success: function(result) {
        if (result == "success") {
          $("#FCModal").modal("hide"); // ëª¨ë‹¬ ë‹«ê¸°
          $("#categoryName").val("");             // ì…ë ¥ê°’ ì´ˆê¸°í™”
          alert("1ì°¨ì¹´í…Œê³ ë¦¬ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
          location.href = "/admin/category/categorymenu"; // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
        }
      },
      error: function(xhr, status, error) {
        alert("ë“±ë¡ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
      }
    });
   });


  /* ------------------------- [ 6ï¸âƒ£ 1ì°¨ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ] ------------------------- */
   $("button#edit-category").on("click", function() {
    if ($("#sel-main option:selected").length === 0) {
      alert("1ì°¨ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }

    // ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ì •ë³´ ëª¨ë‹¬ì— ì±„ì›Œë„£ê¸°
    $("#categoryName").val($("#sel-main option:selected").text());
    $("#categoryCode").val($("#sel-main option:selected").val());

    $("#firstCategoryModalLabel").html("1ì°¨ ì¹´í…Œê³ ë¦¬ ìˆ˜ì •");
    $("#btn_plus_category").hide();
    $("#btn_modify_category").show();

    myModal.show(); // ìˆ˜ì •ìš© ëª¨ë‹¬ ì—´ê¸°
   });

   // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤ì œ ìˆ˜ì • ìš”ì²­
   $("#btn_modify_category").on("click", function() {
      $.ajax({
        url: "/admin/category/editFirstCategory",
        type: "POST",
        data: { cate_code : $("#categoryCode").val(),  cate_name: $("#categoryName").val() },
        dataType: "text",
        success: function(result) {
          if (result == "success") {
            $("#firstCategoryModal").modal("hide");
            $("#categoryName").val("");
            alert("ì¹´í…Œê³ ë¦¬ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
            location.href = "/admin/category/categorymenu";
          }
        },
        error: function(xhr, status, error) {
          alert("ë“±ë¡ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
        }
    });
   });



  /* ------------------------- [ 7ï¸âƒ£ 2ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ ] ------------------------- */

   const myModal2 = new bootstrap.Modal('#sCGModal', { keyboard: false });

   // 2ì°¨ ë“±ë¡ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
   $("#add-second-category").on("click", function() {
    $.ajax({
      url: '/admin/category/firstCategoryList',  // 1ì°¨ ì¹´í…Œê³ ë¦¬ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
      type: 'get',
      dataType: 'json',
      success: function(data) {
        let firstCategoryStr = "";
        for(let i=0; i<data.length; i++) {
          firstCategoryStr += `<option value="${data[i].cate_code}">${data[i].cate_name}</option>`;
        }

        $("select#ssMCategory").empty();
        $("select#ssMCategory").append("<option value=''>1ì°¨ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>");
        $("select#ssMCategory").append(firstCategoryStr);

        $("#btn_plus_secondCategory").show();
        $("#btn_modify_secondCategory").hide();
      }
    });
    myModal2.show(); // 2ì°¨ ë“±ë¡ ëª¨ë‹¬ ì—´ê¸°
   });


   // 2ì°¨ ì¹´í…Œê³ ë¦¬ ë“±ë¡ ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
   $("button#btn_add_secondCategory").on("click", function() {

    let selMainCategory = $("#sMCategory");
    if(selMainCategory.val() == "") {
      alert("1ì°¨ì¹´í…Œê³ ë¦¬ëª…ì„ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }

    let secondCategoryName = $("#sCN").val().trim();
    if (secondCategoryName === "") {
      alert("2ì°¨ì¹´í…Œê³ ë¦¬ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    $.ajax({
      url: "/admin/category/addSecondCategory",
      type: "POST",
      data: { cate_prtcode : $("#selMainCategory").val(), cate_name: $("#sCN").val() },
      dataType: "text",
      success: function(result) {
        if (result == "success") {
          $("#sCGModal").modal("hide");
          $("#sCN").val("");
          alert("2ì°¨ ì¹´í…Œê³ ë¦¬ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("ë“±ë¡ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
      }
    });
   });


   // 2ì°¨ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ â€” ìˆ˜ì • ëª¨ë‹¬ ì¤€ë¹„
   $("#edit-second-category").on("click", function() {
    let firstCateCode = $("#sel-main option:selected").val();
    let secondCateCode = $("#sel-sub option:selected").val();
    let secondCateName = $("#sel-sub option:selected").html();

    if ($("#sel-sub option:selected").length === 0) {
      alert("1ì°¨, 2ì°¨ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }

    // ìˆ˜ì •ìš© ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
    $.ajax({
      url: '/admin/category/firstCategoryList',
      type: 'get',
      dataType: 'json',
      success: function(data) {
        let firstCategoryStr = "";
        for(let i=0; i<data.length; i++) {
          firstCategoryStr += `<option value="${data[i].cate_code}" ${firstCateCode == data[i].cate_code ? 'selected' : ''} >${data[i].cate_name}</option>`;
        }

        $("#sCGModal").html("2ì°¨ì¹´í…Œê³ ë¦¬ ìˆ˜ì •");
        $("select#selMainCategory").empty();
        $("select#selMainCategory").append("<option value=''>1ì°¨ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>");
        $("select#selMainCategory").append(firstCategoryStr);

        $("#secondCategoryCode").val(secondCateCode);
        $("#sCN").val(secondCateName);

        $("#btn_add_secondCategory").hide();
        $("#btn_e_secondCategory").show();

        myModal2.show();
      }
    });
   });


   // 2ì°¨ ì¹´í…Œê³ ë¦¬ ìˆ˜ì • ì €ì¥
   $("#btn_e_secondCategory").on("click", function() {
    $.ajax({
        url: "/admin/category/editSecondCategory",
        type: "POST",
        data: { cate_code : $("#secondCategoryCode").val(),
                cate_name: $("#sCN").val(),
                cate_prtcode :  $("#selMainCategory").val()},
        dataType: "text",
        success: function(result) {
          if (result == "success") {
            $("#sCGModal").modal("hide");
            $("#sCN").val("");
            $("#secondCategoryCode").val("");
            alert("2ì°¨ì¹´í…Œê³ ë¦¬ê°€ ìˆ˜ì •ì™„ë£Œ.");
            location.href = "/admin/category/categorymenu";
          }
        },
        error: function(xhr, status, error) {
          alert("ë“±ë¡ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
        }
    });
   });


   // 1ì°¨ ì¹´í…Œê³ ë¦¬ ì‚­ì œ
   $("button#delete-category").on("click", function() {
    if($("select#sel-main option:selected").length == 0) {
      alert("1ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒí•˜ì„¸ìš”.");
      return;    
    }

    let cate_code = $("select#sel-main option:selected").val();

    $.ajax({
      url: '/admin/category/deleteCategory',
      type: 'post',
      data: {cate_code : cate_code},
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("1ì°¨ ì¹´í…Œê³ ë¦¬ ì‚­ì œë¨");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
      }
    });
   });


   // 2ì°¨ ì¹´í…Œê³ ë¦¬ ì‚­ì œ
   $("button#delete-s-category").on("click", function() {
    if($("select#sel-sub option:selected").length == 0) {
      alert("2ì°¨ ì¹´í…Œê³ ë¦¬ ì„ íƒí•˜ì„¸ìš”.");
      return;    
    }

    let cate_code = $("select#sel-sub option:selected").val();

    $.ajax({
      url: '/admin/category/deleteCategory',
      type: 'post',
      data: {cate_code : cate_code},
      dataType: 'text',
      success : function(result) {
        if(result == "success") {
          alert("2ì°¨ ì¹´í…Œê³ ë¦¬ ì‚­ì œì™„ë£Œ");
          location.href = "/admin/category/categorymenu";
        }
      },
      error: function(xhr, status, error) {
        alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error);
      }
    });
   });

}); // âœ… jQuery ready ë
});


</script>
</th:block>

</html>









